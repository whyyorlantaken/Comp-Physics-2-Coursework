# Atramenta   
                                                                      
**Atramenta** is our python package for simulating orbits of celestial bodies around a black hole with both *classical* and *relativistic* approaches. The implementation has been  divided into three main classes: `OrbitBirther` for initializing the system, `CelestialSeer` for solving the equations of motion, and `ChronoPainter` for creating animations of such orbits.

The name stands for "black ink" in Latin.

## Instructions

### Run/integrator class

To integrate with default parameters and save the initial map as a `.png` and orbital history to an HDF5 file, run the following command:

```sh
python orbits.py CelestialSeer --save_start --save_hdf5
```

If you want to take a look at the orbit over time, you can provide a gif name and number of frames to be used, and such gif will be created. An example command is:

```sh
python orbits.py CelestialSeer \
  --save_hdf5 \
  --gif_name "orbit.gif" \
  --frames 100
```

To have full control over the simulation, you can provide the full set of parameters in the following way:

```sh
python orbits.py CelestialSeer \
  --M 5e6 \
  --a 1.0 \
  --e 0.0167 \
  --N 2 \
  --save_start \
  --relativistic \
  --method "RK3" \
  --steps 4000 \
  --save_hdf5 \
  --gif_name "orbit.gif" \
  --frames 100
```

The output will be (the ASCII art looks better in a terminal):
```sh
=========================================================
    ▗▄▖    ■   ▄▄▄ ▗▞▀▜▌▄▄▄▄  ▗▞▀▚▖▄▄▄▄    ■   ▗▞▀▜▌
   ▐▌ ▐▌▗▄▟▙▄▖█    ▝▚▄▟▌█ █ █ ▐▛▀▀▘█   █ ▗▄▟▙▄▖▝▚▄▟▌
   ▐▛▀▜▌  ▐▌  █         █   █ ▝▚▄▄▖█   █   ▐▌       
   ▐▌ ▐▌  ▐▌                               ▐▌       
          ▐▌                               ▐▌       
=========================================================

Initializing CelestialSeer (integrator class):
    Black hole mass:        5.0e+06 [M_sun]
    Semi-major axis (a):    1.0 [AU]
    Eccentricity (e):       0.017

    Integrating equations of motion:
        Periods (N):        2.0
        Method:             RK3
        Steps:              4000
        Relativistic:       True
        Save HDF5:          True

Saved to outputfolder/M5.0e+06-a1.0-e0.017-relat-RK3.h5.
----------------------------------------------------------
                  STARTING GIF CREATION
----------------------------------------------------------
Saving 100 frames...
----------------------------------------------------------
Progress: 0% (0 images)
Progress: 10% (10 images)
Progress: 20% (20 images)
Progress: 30% (30 images)
Progress: 40% (40 images)
Progress: 50% (50 images)
Progress: 60% (60 images)
Progress: 70% (70 images)
Progress: 80% (80 images)
Progress: 90% (90 images)
----------------------------------------------------------
All 100 frames saved to outputfolder/sketches.
----------------------------------------------------------
Assembling the GIF...
----------------------------------------------------------
GIF saved to outputfolder/orbit.gif.
----------------------------------------------------------
All frames have been deleted.
----------------------------------------------------------
                   END OF GIF CREATION
----------------------------------------------------------

DONE. Final time on planet: 8.9e-04 Earth years.

==========================================================
```

### Animation class

To create an animation of one or multiple orbits together, you can use the `ChronoPainter` class. This class takes as input HDF5 files generated by the `CelestialSeer`, and creates a gif with the orbits (files are assumed to be in `outputfolder`). It can be used in the following way:

```sh
python orbits.py ChronoPainter \
  --orbits M5.0e+06-a1.0-e0.017-relat-RK3.h5 M5.0e+06-a1.0-e0.017-class-RK3.h5 \
  --labels "Relat" "Class" \
  --colors "magenta" "khaki" \
  --gif_name "orbit2.gif" \
  --duration 0.1 \
  --frames 100 \
  --dpi 120
```

The output is similar to the one above:

```sh
=========================================================
    ▗▄▖    ■   ▄▄▄ ▗▞▀▜▌▄▄▄▄  ▗▞▀▚▖▄▄▄▄    ■   ▗▞▀▜▌
   ▐▌ ▐▌▗▄▟▙▄▖█    ▝▚▄▟▌█ █ █ ▐▛▀▀▘█   █ ▗▄▟▙▄▖▝▚▄▟▌
   ▐▛▀▜▌  ▐▌  █         █   █ ▝▚▄▄▖█   █   ▐▌       
   ▐▌ ▐▌  ▐▌                               ▐▌       
          ▐▌                               ▐▌       
=========================================================

Initializing ChronoPainter (animation class):
    Orbits: 
        M5.0e+06-a1.0-e0.017-relat-RK3.h5
        M5.0e+06-a1.0-e0.017-class-RK3.h5
    Labels: Relat, Class
    Colors: magenta, khaki

    Creating animation:
        GIF name:   orbit2.gif
        Duration:   0.1
        Frames:     100
        DPI:        120

----------------------------------------------------------
                  STARTING GIF CREATION
----------------------------------------------------------
Saving 100 frames...
----------------------------------------------------------
Progress: 0% (0 images)
Progress: 10% (10 images)
Progress: 20% (20 images)
Progress: 30% (30 images)
Progress: 40% (40 images)
Progress: 50% (50 images)
Progress: 60% (60 images)
Progress: 70% (70 images)
Progress: 80% (80 images)
Progress: 90% (90 images)
----------------------------------------------------------
All 100 frames saved to outputfolder/sketches.
----------------------------------------------------------
Assembling the GIF...
----------------------------------------------------------
GIF saved to outputfolder/orbit2.gif.
----------------------------------------------------------
All frames have been deleted.
----------------------------------------------------------
                   END OF GIF CREATION
----------------------------------------------------------

DONE. Animation created successfully.

==========================================================
```

We're happy with the results.